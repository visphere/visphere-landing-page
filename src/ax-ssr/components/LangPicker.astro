---
/*
 * Copyright (c) 2023 by MILOSZ GILGA <https://miloszgilga.pl>
 * Silesian University of Technology
 *
 *   File name: LangPicker.astro
 *   Created at: 2023-08-29, 17:12:18
 *   Last updated at: 2023-08-29, 17:12:18
 *
 *   Project name: moonsphere
 *   Module name: moonsphere-landing-page
 *
 * This project is a part of "MoonSphere" instant messenger system. This system is a part of
 * completing an engineers degree in computer science at Silesian University of Technology.
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
 * file except in compliance with the License. You may obtain a copy of the License at
 *
 *   <http://www.apache.org/license/LICENSE-2.0>
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the license.
 */
import ChangeLang from '~/ax-csr/components/ChangeLang';
import { environment } from '~/env/environment';
import { i18nWithoutLangPrefixHref } from '~/i18n/url-parser';
import { getSafetyLocaleSSR } from '~/i18n/utils';

type Props = {
  theme?: 'light' | 'dark';
  hideLabels?: boolean;
  position?: 'top' | 'bottom';
};

const {
  theme = 'dark',
  hideLabels = false,
  position = 'top',
} = Astro.props as Props;

const locale = getSafetyLocaleSSR(Astro.url);
const { contentDistributorBaseUrl: cdnUrl, i18nLocalesMap } = environment;
---

<ChangeLang
  client:load
  currentLocale={locale}
  hideLabels={hideLabels}
  theme={theme}
  position={position}>
  {
    i18nLocalesMap.map(({ id, name, value }) => (
      <li>
        <a
          href={i18nWithoutLangPrefixHref(Astro.url.pathname, id)}
          class:list={[
            'msph_footer__select-list-element',
            theme === 'dark' ? 'hover:bg-gray-600' : 'hover:bg-gray-200',
            value === locale.locale &&
              'msph_footer__select-list-element--active',
          ]}>
          <img
            src={`${cdnUrl}/static/icon/lang/${value}.png`}
            width="23"
            height="23"
            class="me-2"
            alt=""
          />
          <p>{name}</p>
        </a>
      </li>
    ))
  }
</ChangeLang>
